# Быстрый старт

Этот документ для тех, кто хочет быстро запустить `phew`, встроить его в повседневный цикл и не разбираться в реализации.

## Что делает `phew` за 30 секунд

- Форматирует смешанные Yii2 view-файлы (`.php`, `.html`) с HTML + PHP.
- Нормализует отступы, пробелы и переносы строк.
- Выравнивает `if/elseif/else`, `foreach`, `for`, `while`, `switch/case` (alt-синтаксис и brace-синтаксис).
- Стабилизирует header-блок (`declare`, `use`, phpdoc).
- Держит длину строк около лимита `120` символов, где это безопасно.
- Сохраняет POSIX EOF: в конце файла ровно один `\n`.

## Быстрый запуск

```bash
# Показать версию
phew

# Форматировать файл в stdout
phew views/site/index.php

# Форматировать файл с записью
phew -w views/site/index.php

# Форматировать директорию рекурсивно
phew -w views/
```

## Рекомендуемый рабочий цикл

```bash
# Шаг 1. Локально форматируешь только нужные view
phew -w views/

# Шаг 2. Если менял код форматтера, прогоняешь тесты
just test
just fixtures
```

## Что форматтер гарантирует

- Идемпотентность: второй прогон не меняет уже отформатированный файл.
- Корректный `switch/case`: без вывода между `switch` и первым `case`.
- Читаемый header: без хаотичных `?><?php` между `use` и phpdoc.
- Стабильные diff-ы: повторные прогоны не создают шум.

## Что форматтер сознательно не трогает

- Содержимое raw-text блоков `<script>`, `<style>`, `<textarea>`.
- Текст внутри `registerJs(...)`, `registerCss(...)`, heredoc и nowdoc.

Это сделано специально, чтобы не ломать форматирование JS/CSS и многострочных строк.

## Быстрая диагностика

```bash
# Проверить токены лексера
phew --tokens path/to/file.php

# Проверить AST-дерево
phew --tree path/to/file.php
```

Если итог выглядит странно, смотри, на каком этапе файл "поехал": токены или дерево.

## Что читать дальше

- Подробный разбор пайплайна и диаграммы: [`docs/how-it-works.md`](how-it-works.md)
- Техгид по внутренностям на уровне Rust-кода: [`docs/rust-developer-guide.md`](rust-developer-guide.md)
- Практический гайд по поведению форматтера для Yii2-шаблонов: [`docs/php-developer-guide.md`](php-developer-guide.md)
